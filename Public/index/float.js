//2015-12-10
var tq_is_defined_float_css=0;if(typeof(TQKF.userDefined.float_css)!="undefined"&&TQKF.userDefined.float_css!=""){tq_is_defined_float_css=1}tq_title=TQUtils.setDefaultValue((typeof(tq_software_name)=="undefined"?TQKF.words[0]:tq_software_name),tq_title);TQKF.floater={isMouseInBox:false,isClosed:false,isHided:false,hasInited:false,isAntiKaKa:true,autiTimer:null,DOM:null,DOMinnerHTML:null,heartBeatTimer:null,lastScrollX:0,lastScrollY:0,isMouseInButton:0,t:tq_float_type,s:tq_float_style,c:tq_color,OFFLINE:0,ONLINE:22,BUSY:24,autoReshowTimer:null,showTimes:1,float_layout_cfg:new Object(),resource:{word:{title:TQKF.words[0],on:TQKF.words[12],off:TQKF.words[13],busy:TQKF.words[17],leave:TQKF.words[19]}},miniCfg:{s1:{ext:"png"},s2:{ext:"png"},s3:{ext:"png"},s101:{ext:"gif"},s102:{ext:"gif"},s103:{ext:"gif"},s104:{ext:"png"}},defaultCfg:{t1:{s1:{img_ext:"gif",term:{img:"",h:"20",bgimg:"1"},head:{img:"",w:"118",h:"35"},body:{img:"",margin:6,h:"auto",sort:""},down:{img:"",tip:"",herf:"",disp:"1"},btm:{img:"",tip:"",herf:"",disp:"1"},icoon:{img:""},icooff:{img:""},on:{img:""},off:{img:""},busy:{img:""},leave:{img:""},onlinestate:{s:"1"},title:{t:"6",l:"2",h:"16",w:"96"},close:{t:"3",r:"1",h:"16",w:"15"},mini:{s:"1",img:"",disp:"0",expd:"0"}},s2:{img_ext:"png",term:{img:"",h:"20",bgimg:"0"},head:{img:"",w:"127",h:"62"},body:{img:"",margin:7,h:"auto",sort:""},down:{img:"",tip:"",herf:"",disp:"1"},btm:{img:"",tip:"",herf:"",disp:"1"},icoon:{img:""},icooff:{img:""},on:{img:""},off:{img:""},busy:{img:""},leave:{img:""},onlinestate:{s:"0"},title:{t:"4",l:"5",h:"16",w:"96"},close:{t:"3",r:"2",h:"16",w:"15"},mini:{s:"1",img:"",disp:"0",expd:"0"}},s3:{img_ext:"png",term:{img:"",h:"20",bgimg:"0"},head:{img:"",w:"125",h:"50"},body:{img:"",margin:5,h:"auto",sort:""},down:{img:"",tip:"",herf:"",disp:"1"},btm:{img:"",tip:"",herf:"",disp:"1"},icoon:{img:""},icooff:{img:""},on:{img:""},off:{img:""},busy:{img:""},leave:{img:""},onlinestate:{s:"0"},title:{t:"4",l:"5",h:"16",w:"96",disp:"0"},close:{t:"3",r:"3",h:"16",w:"16"},mini:{s:"1",img:"",disp:"0",expd:"0"}},s101:{img_ext:"gif",term:{img:"",h:"26",bgimg:"1"},head:{img:"",w:"137",h:"39"},body:{img:"",margin:10,h:"auto",sort:""},down:{img:"",tip:"",herf:"",disp:"1"},btm:{img:"",tip:"",herf:"",disp:"1"},icoon:{img:""},icooff:{img:""},on:{img:""},off:{img:""},busy:{img:""},leave:{img:""},onlinestate:{s:"0"},title:{t:"6",l:"5",h:"16",w:"96",disp:"1"},close:{t:"3",r:"3",h:"16",w:"16"},mini:{s:"101",img:"",disp:"0",expd:"0"}},s104:{img_ext:"png",term:{img:"",h:"21",bgimg:"1"},head:{img:"",w:"118",h:"36"},body:{img:"",margin:4,h:"auto",sort:""},down:{img:"",tip:"",herf:"",disp:"0"},btm:{img:"",tip:"",herf:"",disp:"1"},icoon:{img:""},icooff:{img:""},on:{img:""},off:{img:""},busy:{img:""},leave:{img:""},onlinestate:{s:"0"},title:{t:"0",l:"5",h:"25",w:"86",disp:"0"},close:{t:"7",r:"7",h:"16",w:"16"},mini:{s:"102",img:"",disp:"0",expd:"0"}}},t2:{s1:{img_ext:"",term:{h:"20"},head:{w:"120",h:"25"},body:{margin:5,h:"auto",sort:""},down:{tip:"",herf:"",disp:""},btm:{tip:"",herf:""},icoon:"",icooff:"",on:"",off:"",busy:"",leave:"",onlinestate:{s:"0"},title:{t:"6",l:"3"},close:{t:"3",r:"0",w:"16"},mini:{s:"1",img:"",disp:"0",expd:"0"}}}},imToolsConfig:{qq:{iconStylePath:"http://pub.idqqimg.com/qconn/wpa/button/button_(STYLE)(ONLINESTATE).gif",onlineStateString:{online:"1",offline:"0"},available_style_nums:[41,42,44,45,46,47,49,101,102,103,104,105,106,107,108,109,110,111],onlineIconURL:"http://wpa.qq.com/pa?p=1:(ID):(STYLE)",chatURL:"tencent://message/?uin=(ID)&Site=&Menu=yes"},msn:{iconStylePath:"http://sysimages.tq.cn/images/vip/imtools/msn/on(STYLE).gif",onlineStateString:{online:"Online",offline:"Offline"},available_style_nums:[1,2],onlineIconURL:"http://sysimages.tq.cn/images/vip/imtools/msn/on(STYLE).gif",chatURL:"msnim:chat?contact=(ID)"},ww:{iconStylePath:"http://img.im.alisoft.com/actions/wbtx/wangwang/(STYLE)/(ONLINESTATE).gif",onlineStateString:{online:"online",offline:"offline"},available_style_nums:[1,2,4],onlineIconURL:"http://amos1.taobao.com/online.aw?site=cntaobao&charset=utf-8&v=2&uid=(ID)&s=(STYLE)",chatURL:"http://amos1.taobao.com/msg.aw?site=cntaobao&charset=utf-8&v=2&uid=(ID)&s=1"},aliww:{iconStylePath:"http://img.im.alisoft.com/actions/wbtx/alitalk/(STYLE)/(ONLINESTATE).gif",onlineStateString:{online:"online",offline:"offline"},available_style_nums:[5,4,2],onlineIconURL:"http://web.im.alisoft.com/online.aw?v=2&uid=(ID)&s=(STYLE)&site=cnalichn&charset=utf-8",chatURL:"http://web.im.alisoft.com/msg.aw?v=2&uid=(ID)&site=cnalichn&s=1&charset=utf-8"},skype:{iconStylePath:"http://sysimages.tq.cn/images/vip/imtools/skype/(STYLE)/(ONLINESTATE).png",onlineStateString:{online:"online",offline:"offline"},available_style_nums:["smallicon","mediumicon"],onlineIconURL:"http://sysimages.tq.cn/images/vip/imtools/skype/(STYLE)/online.png",chatURL:"skype:(ID)?chat"}},imToolsImgPath:"http://sysimages.tq.cn/images/vip/imtools/",userCfg:null,CreatDOM:function(){this.userCfg=this.defaultCfg["t"+this.t]["s"+this.s];TQUtils.SetValue(this.float_layout_cfg,this.userCfg);if(this.DOM!=null)return;var isMini=(this.userCfg.mini.disp>0);var tempW=this.userCfg.head.w;if(this.t==2&&this.s==1){if(this.userCfg.head.w==""||this.userCfg.head.w=="120"){var maxNameLth=0;try{var count=0;for(var t=0;t<tq_member_uins.length;t++){for(var i=0;i<tq_member_uins[t].m.length;i++){var tempLth=this.GetLen(unescape(tq_member_uins[t].m[i].n).replace(/<br>/gi,"")+"");if(tempLth>maxNameLth)maxNameLth=tempLth;count++}{if(maxNameLth>10)tempW=(maxNameLth-10)*6+120}}if(tq_group_flag==1&&count>25){tempW=parseInt(tempW)+20;this.DOM.style.height="450px"}}catch(e){}}}this.DOM=document.createElement("div");this.DOM.id="tq_float_container";this.DOM.className="tq_div_main";this.DOM.style.border="0px ridge #EAEAEA";{}this.DOM.style.visibility="";this.DOM.style.display="";if(TQKF.userDefined.isfloat==2&&TQUtils.isSupportFixedPos)this.DOM.style.position="fixed";else this.DOM.style.position="absolute";this.DOM.style.top=tq_top+"px";this.DOM.style.zIndex="9998";if(isMini){if(parseInt(tq_float_right)<0){if(TQKF.userDefined.isfloat==2&&TQUtils.isSupportFixedPos)this.DOM.style.right="0px";else{this.DOM.style.left=TQUtils.GetScrollLeft()+TQUtils.GetWinSize().w-parseInt(this.userCfg.head.w)+"px"}}else this.DOM.style.left="0px"}else{if(parseInt(tq_float_right)<0){if(TQKF.userDefined.isfloat==2&&TQUtils.isSupportFixedPos){this.DOM.style.right=(-parseInt(tq_float_right)-1)+"px"}else{this.DOM.style.left=(TQUtils.GetScrollLeft()+TQUtils.GetWinSize().w-parseInt(this.userCfg.head.w)+parseInt(tq_float_right)+1)+"px"}}else this.DOM.style.left=tq_float_right+"px"}var title=(tq_title=="")?TQKF.words[0]:tq_title;var html=[];var hFlag="left";if(parseInt(tq_float_right)<0)hFlag="right";var tempC=this.c>1?(this.c>10?9:this.c-1):(this.c<0?0:this.c);if(isMini){var autoMiniStr='';if(typeof(TQKF.userDefined.floatMaxStatusCloseMode)!="undefined"&&TQKF.userDefined.floatMaxStatusCloseMode=="0"){autoMiniStr=' onmouseout="TQKF.floater.AutoShrink(event)" '}if(this.t==2&&this.s==1){html.push('<div id=tq_float_normal_container style="float:'+hFlag+';width:'+(parseInt(tempW)+6)+'px">','<div id=tq_float_normal '+autoMiniStr+' class="tracq_fix_div" style="background-color:#EFEFEF;border: 2px solid '+TQKF.color[tempC]+';width: '+(parseInt(tempW)+2)+'px;">')}else{html.push('<div id=tq_float_normal_container '+autoMiniStr+' style="float:'+hFlag+';width:'+tempW+'px">','<div id=tq_float_normal class="tracq_fix_div" style="border: 0px solid #FFFFFF; width: '+tempW+'px;">')}}if(this.t==2&&this.s==1){if(!isMini){this.DOM.style.border="2px solid "+TQKF.color[tempC];this.DOM.style.backgroundColor="#EFEFEF";this.DOM.style.width=parseInt(tempW)+2+"px"}html.push('<div id=tq_float_head style="'+(isMini?'':'cursor:move;')+'border:1px solid #EFEFEF;text-align:left;width:'+tempW+'px;height:'+this.userCfg.head.h+'px;BACKGROUND-COLOR: '+TQKF.color[tempC]+'">','<div style="height:14px;line-height:14px;color:#FFFFFF;float:left;margin-left:'+this.userCfg.title.l+'px; margin-top:'+this.userCfg.title.t+'px" id="tq_float_title">'+title+'</div>','<div style="color:#FFFFFF;font-size:18px;float:right; width:'+this.userCfg.close.w+'px;margin-right:'+this.userCfg.close.r+'px; margin-top:'+this.userCfg.close.t+'px;cursor:pointer" id="tq_float_close" onclick="TQKF.floater.Close()">'+unescape("%D7")+'</div>','</div>','<div id=tq_float_body style="height:auto">','<div id=tq_float_m_content style="height:auto;padding-bottom:3px;margin-left:'+this.userCfg.body.margin+'px;margin-right:'+this.userCfg.body.margin+'px;">',this.DrawContent(),'</div>',this.DrawDefinedHTML(),'</div>');if(tq_iscallback==1&&tq_language==1){html.push('<div id=tq_float_foot style="height:auto;line-height:12px;cursor:pointer;padding-bottom:5px">','<div title="'+this.userCfg.down.tip+'" onclick=TQKF.floater.OpenCallback() style="cursor:pointer;color:#FF9900;text-align:center;border:1px solid #A5A5A5;height:25px;line-height:200%;margin-left:5px;margin-right:5px;margin-top:5px;BACKGROUND-COLOR:#FFFFFF">='+TQKF.words[14]+'=</div>','</div>')}else{html.push('<div id=tq_float_foot style="line-height:12px;height:5px;cursor:pointer;"></div>')}}else{var head_img=this.CreatImgURL(this.userCfg.head.img,"head");var body_img=this.CreatImgURL(this.userCfg.body.img,"body");var down_img=this.CreatImgURL(this.userCfg.down.img,"down");var btm_img=this.CreatImgURL(this.userCfg.btm.img,"btm");var temp_hStr=(typeof(this.userCfg.body.h)=="undefined"||this.userCfg.body.h==""||this.userCfg.body.h=="auto")?'height:auto;':('height:'+this.userCfg.body.h+'px;overflow-y:scroll;');var dispStr2='';if(typeof(this.userCfg.title.disp)!="undefined"&&this.userCfg.title.disp=="0")dispStr2='display:none;';html.push('<div id=tq_float_head style="'+(isMini?'':'cursor:move;')+'text-align:left;width:'+tempW+'px;height:'+this.userCfg.head.h+'px;background-image:url('+head_img+');">','<div style="'+dispStr2+'float:left;width:'+this.userCfg.title.w+'px; height:'+this.userCfg.title.h+'px; margin-left:'+this.userCfg.title.l+'px; margin-top:'+this.userCfg.title.t+'px" id="tq_float_title">'+title+'</div>','<div style="float:right; width:'+this.userCfg.close.w+'px; height:'+this.userCfg.close.h+'px; margin-right:'+this.userCfg.close.r+'px; margin-top:'+this.userCfg.close.t+'px;cursor:pointer;BACKGROUND-COLOR: #FFFFFF; FILTER: Alpha(opacity=0); opacity: 0;" id="tq_float_close" onclick="TQKF.floater.Close()"></div>','</div>','<div id=tq_float_body style="height:auto;padding-left:'+this.userCfg.body.margin+'px;padding-right:'+this.userCfg.body.margin+'px;background-position: left top; background-image:url('+body_img+'); background-repeat:repeat-y">','<div id=tq_float_m_content style="'+temp_hStr+'padding-bottom:3px;width:'+(parseInt(tempW)-parseInt(this.userCfg.body.margin)*2)+'px">',this.DrawContent(),'</div>',this.DrawDefinedHTML(),'</div>');if(this.s==2){html.push('<div id=tq_float_foot style="height:auto;line-height:12px;cursor:pointer">','<div style="height:auto;line-height:12px;" title="'+this.userCfg.btm.tip+'"><img onclick=TQKF.floater.OpenAgentSite() id=tq_float_btm border="0" src="'+btm_img+'"></div>',(tq_iscallback==1&&tq_language==1)?'<div style="height:auto;line-height:12px;margin-top:3px;cursor:pointer" title="'+this.userCfg.down.tip+'"><img onclick=TQKF.floater.OpenCallback() id=tq_float_down border="0" src="'+down_img+'"></div>':'','</div>')}else{html.push('<div id=tq_float_foot style="height:auto;line-height:12px;cursor:pointer">',(tq_iscallback==1&&tq_language==1)?'<div style="height:auto;line-height:12px;cursor:pointer" title="'+this.userCfg.down.tip+'"><img onclick=TQKF.floater.OpenCallback() id=tq_float_down border="0" src="'+down_img+'"></div>':'','<div style="height:auto;line-height:12px;cursor:pointer" title="'+this.userCfg.btm.tip+'"><img onclick=TQKF.floater.OpenAgentSite() id=tq_float_btm border="0" src="'+btm_img+'"></div>','</div>')}}if(isMini){var mini_img=this.CreatMiniImgURL(this.userCfg.mini.s);html.push('</div>','</div>','<div id=tq_float_mini_container style="height:auto;display:none;cursor:pointer;float:'+hFlag+';">','<img id=tq_float_mini src="'+mini_img+'" '+(this.userCfg.mini.expd==0?'onmouseover':'onclick')+'="TQKF.floater.Max()"/>','</div>')}this.DOMinnerHTML=this.DOM.innerHTML=html.join('')},AppendDOM:function(){TQUtils.AppendDOM(TQKF.floater.DOM)},SortMemberByOnlineFlag:function(arr){var getFlag=function(m){if(m.t!="tq")return 5;if(m.o==TQKF.OFFLINE)return 4;else if(TQKF.BUSY.indexOf(m.o)!=-1)return 3;else if(TQKF.LEAVE.indexOf(m.o)!=-1)return 2;else if(TQKF.ONLINE.indexOf(m.o)!=-1)return 1;return 4};var asc=function(a,b){if(getFlag(a)>getFlag(b))return 1;if(getFlag(a)<getFlag(b))return-1;return 0};return arr.sort(asc)},DrawContent:function(){if(tq_group_flag==1){return this.DrawTerm()}else{return this.DrawMember(tq_member_uins[0].m)}},DrawDefinedHTML:function(){if(tq_float_html=="")return'';else return'<div id=float_defined_html style="height:auto;padding-top:3px;width:'+(parseInt(this.userCfg.head.w)-parseInt(this.userCfg.body.margin*2))+'px">'+tq_float_html+'</div>'},DrawTerm:function(){var html=[];for(var i=0;i<tq_member_uins.length;i++){var t=tq_member_uins[i];var toggleStr='';var dispStr='';if(tq_is_fold_term==1){toggleStr=' onmouseover="TQKF.floater.Toggle(this)"';dispStr='display:none;'}if(this.t==2){var tempC=this.c>1?(this.c>10?9:this.c-1):(this.c<0?0:this.c);html.push('<div id=tq_float_term'+i+' style="height:auto;BACKGROUND-COLOR:#FFFFFF;height:'+(t.h==""?this.userCfg.term.h:t.h)+'px;margin-top:4px;border:1px solid '+TQKF.color[tempC]+'" '+toggleStr+'>','<div style="height:auto;text-align:center;line-height:150%">'+t.n+'</DIV>','</DIV>','<div id=tq_float_term'+i+'_member style="height:auto;padding-bottom:3px;'+dispStr+'">',this.DrawMember(t.m),'</div>')}else{if(this.t==1&&this.userCfg.term.bgimg==1||t.b!=""){html.push('<table id=tq_float_term'+i+' width="100%" border="0" cellspacing="0" cellpadding="0" style="height:'+(t.h==""?this.userCfg.term.h:t.h)+'px;background-position:center;background-image:url('+this.CreatImgURL(t.b,"term_bg")+'); background-repeat:no-repeat" '+toggleStr+'>','<tr>','<td style="text-align:center" align=center>'+t.n+'</td>','</tr>','</table>')}else{html.push('<table id=tq_float_term'+i+' width="100%" border="0" cellspacing="0" cellpadding="0" style="height:'+(t.h==""?this.userCfg.term.h:t.h)+'px;" '+toggleStr+'>','<tr>','<td align=left style="font-weight:bold">&nbsp;'+t.n+'</td>','</tr>','</table>')}html.push('<div id=tq_float_term'+i+'_member style="height:auto;padding-bottom:3px;'+dispStr+'">',this.DrawMember(t.m),'</div>')}}return html.join('')},DrawMember:function(members){var html=[];if(members.length==0)return'';var h=this.FixMemberHeight();if(this.t==1&&this.s==104){for(var i=0;i<members.length;i++){if(i!=0)html.push('<img src='+TQKF.float_image_url+'t'+this.t+'/s'+this.s+'/split.png />');var m=members[i];var onclickStr=' onclick="TQKF.floater.OpenChatWin('+m.id+','+m.o+')"';if(m.t=="tactic")onclickStr=' onclick="TQKF.floater.OpenTacticChatWin('+m.id+')"';var fixedWidth='100%';if(!(this.t==2&&this.s==1)&&this.userCfg.body.h!=""&&this.userCfg.body.h!="auto")fixedWidth=(parseInt(this.userCfg.head.w)-parseInt(this.userCfg.body.margin)*2-20)+'px';var kefuTitle=' title="'+m.w+'"';if(typeof(m.w)=="undefined"||m.w=="\u6211\u662f"||m.w=="\\u6211\\u662f"||m.w=="\\u6211\\u662fnull"||m.w=="\u6211\u662fnull"||m.w.toLowerCase()=="null"||m.w=="")kefuTitle='';if(m.t=="tq"||m.t=="tactic"){if(typeof(m.wn)!="undefined"&&m.wn!="")m.n=m.wn;m.n=m.n.replace(/<br>/gi,"");var len=this.GetLen(m.n);html.push('<div style="height:28px;overflow: visible;cursor:pointer;;width: '+fixedWidth+'" '+onclickStr+kefuTitle+'>','<div style="height:20px;margin-right:8px;margin-left:8px;margin-top:4px;float:left;OVERFLOW: visible;">'+this.DrawImg(m)+'</div>','<div style="height:28px;OVERFLOW: visible;float:left;line-height:28px;">'+m.n+'</div>','</div>')}else{if(m.t=="ww"||m.t=="aliww")m.id=encodeURI(m.id);var r=m.s;var imgPathTemp="";if(m.s>200){imgPathTemp=this.imToolsImgPath+m.t+"/"+m.s+".gif"}else if(m.s>100){var index=tq_getQQUinIndex(m.id);var onStr="on";if(index==-1||online[index]==0){onStr="off"}imgPathTemp=this.imToolsImgPath+m.t+"/"+onStr+m.s+".gif"}else{imgPathTemp=this.imToolsConfig[m.t].onlineIconURL.replace("(ID)",m.id).replace("(STYLE)",r)}var skype_click="";if(m.t=="skype")skype_click='';html.push('<div style="height:28px;overflow: visible;cursor:pointer;;width: '+fixedWidth+'" '+kefuTitle+'>','<div style="height:20px;margin-right:8px;margin-left:8px;margin-top:4px;float:left;OVERFLOW: visible;"><a'+skype_click+' style="text-decoration:none;" href="'+this.imToolsConfig[m.t].chatURL.replace("(ID)",m.id)+'" target=_blank><img ALIGN=absmiddle border="0" src="'+imgPathTemp+'" /></a></div>','<div style="height:28px;line-height:28px;OVERFLOW: visible;float:left;"><a'+skype_click+' style="text-decoration:none;" href="'+this.imToolsConfig[m.t].chatURL.replace("(ID)",m.id)+'" target=_blank>'+m.n+'</a></div>','</div>')}}}else{var member_height="auto";var isMargin=true;if(typeof(TQKF.userDefined.float_member_h)!="undefined"&&TQKF.userDefined.float_member_h!="auto"){member_height=TQKF.userDefined.float_member_h;isMargin=false}for(var i=0;i<members.length;i++){var m=members[i];var onclickStr=' onclick="TQKF.floater.OpenChatWin('+m.id+','+m.o+')"';if(m.t=="tactic")onclickStr=' onclick="TQKF.floater.OpenTacticChatWin('+m.id+')"';if(typeof(TQKF.userDefined.kefuClickEvent)!="undefined"&&TQKF.userDefined.kefuClickEvent!=null){try{var es=TQKF.userDefined.kefuClickEvent.split(",");if(es[i]&&es[i]!=null&&es[i]!="null"){onclickStr=' onclick="'+es[i]+'()"'}}catch(e){}}var fixedWidth='100%';if(!(this.t==2&&this.s==1)&&this.userCfg.body.h!=""&&this.userCfg.body.h!="auto")fixedWidth=(parseInt(this.userCfg.head.w)-parseInt(this.userCfg.body.margin)*2-20)+'px';var kefuTitle=' title="'+m.w+'"';if(typeof(m.w)=="undefined"||m.w=="\u6211\u662f"||m.w=="\\u6211\\u662f"||m.w=="\\u6211\\u662fnull"||m.w=="\u6211\u662fnull"||m.w.toLowerCase()=="null"||m.w=="")kefuTitle='';if(m.t=="tq"||m.t=="tactic"){if(typeof(m.wn)!="undefined"&&m.wn!="")m.n=m.wn;m.n=m.n.replace(/<br>/gi,"");var len=this.GetLen(m.n);if(len>TQKF.userDefined.maxFloatMemberNameChars&&this.t!=2){html.push('<DIV id=tq_member_div '+kefuTitle+(tq_is_defined_float_css==1?('style="'+TQUtils.getCssTextById("tq_member_div",TQKF.userDefined.float_css)+'"'):(' style="OVERFLOW: visible; WIDTH: '+fixedWidth+'; CURSOR: pointer; PADDING-TOP: 2px; HEIGHT:'+member_height+'; TEXT-ALIGN: center" '))+onclickStr+'>',this.DrawIcon(m)+m.n+'<BR>'+this.DrawImg(m),'</DIV>')}else{html.push('<div id=tq_member_div '+(tq_is_defined_float_css==1?('style="'+TQUtils.getCssTextById("tq_member_div",TQKF.userDefined.float_css)+'"'):('style="overflow: visible;cursor:pointer;'+(isMargin==true?('height:14px;margin-top:'+parseInt((h-14)/2+3)+'px;margin-bottom:'+parseInt((h-14)/2))+'px':'height:'+member_height)+';width: '+fixedWidth+'" '))+onclickStr+kefuTitle+'>','<div id=tq_member_div_ico '+(tq_is_defined_float_css==1?('style="'+TQUtils.getCssTextById("tq_member_div_ico",TQKF.userDefined.float_css)+'"'):('style="height:'+member_height+';float:left;OVERFLOW: visible;"'))+'>'+this.DrawIcon(m)+'</div>','<div id=tq_member_div_kefuName '+(tq_is_defined_float_css==1?('style="'+TQUtils.getCssTextById("tq_member_div_kefuName",TQKF.userDefined.float_css)+'"'):('style="height:'+member_height+';OVERFLOW: visible;float:left;"'))+'>'+m.n+'</div>','<div id=tq_member_div_onlineIco '+(tq_is_defined_float_css==1?('style="'+TQUtils.getCssTextById("tq_member_div_onlineIco",TQKF.userDefined.float_css)+'"'):('style="height:'+member_height+';float:right;text-align:center;OVERFLOW: visible;">'))+this.DrawImg(m)+'</div>','</div>')}}else{if(m.t=="ww"||m.t=="aliww")m.id=encodeURI(m.id);var r=m.s;var imgPathTemp="";if(m.s>200){imgPathTemp=this.imToolsImgPath+m.t+"/"+m.s+".gif"}else if(m.s>100){var index=tq_getQQUinIndex(m.id);var onStr="on";if(index==-1||online[index]==0){onStr="off"}imgPathTemp=this.imToolsImgPath+m.t+"/"+onStr+m.s+".gif"}else{imgPathTemp=this.imToolsConfig[m.t].onlineIconURL.replace("(ID)",m.id).replace("(STYLE)",r)}var skype_click="";if(m.t=="skype"){skype_click=' onclick="return skypeCheck();"'}html.push('<div id=tq_member_div style="height:auto;text-align:center" '+kefuTitle+'><a'+skype_click+' style="text-decoration:none;" href="'+this.imToolsConfig[m.t].chatURL.replace("(ID)",m.id)+'" target=_blank><img ALIGN=absmiddle border="0" src="'+imgPathTemp+'" />'+m.n+'</a></div>');}}}return html.join('');},DrawIcon:function(member){var name="off";if(TQUtils.isInCode(member.o,TQKF.ONLINE)){name="on";}var url='';if(member.t=="tq"||member.t=="tactic"){if(this.t==2){var tempC=this.c>1?(this.c>10?9:this.c-1):(this.c<0?0:this.c);return'<span style="width:auto;color:'+TQKF.color[tempC]+'">'+unescape("%u2606")+'</span>';}else url=(TQUtils.isInCode(member.o,TQKF.ONLINE)?this.CreatImgURL(this.userCfg.icoon.img,"icoon"):this.CreatImgURL(this.userCfg.icooff.img,"icooff"));}else{var r=member.s;url=(this.imToolsConfig[member.t].onlineIconURL.replace("(ID)",member.id).replace("(STYLE)",r));}return'<img id=tq_float_ico'+name+' ALIGN=absmiddle src="'+url+'">';},DrawImg:function(member){var name="off";if(TQUtils.isInCode(member.o,TQKF.ONLINE)){name="on";}else if(TQUtils.isInCode(member.o,TQKF.BUSY)){name="busy";}else if(TQUtils.isInCode(member.o,TQKF.LEAVE)){name="leave";}if(this.userCfg.onlinestate.s==0||this.t==2)return'<span style="width:auto;" id=tq_float_'+name+' class=tq_float_'+name+'>'+this.resource.word[name]+'</span>';else{return'<span style="width:auto;" id=tq_float_'+name+' class=tq_float_'+name+'><img ALIGN=absmiddle src="'+this.CreatOnlineStateImgURL(this.userCfg[name].img,name+TQKF.ltype_str)+'"></span>';}},GetOnlineStatus:function(){if(TQKF.floater.isClosed==true)return;var str=[];for(var i=0;i<tq_member_uins.length;i++){for(var j=0;j<tq_member_uins[i].m.length;j++){var m=tq_member_uins[i].m[j];if(m.t=="tq"||m.t=="tactic"){str.push("{\"t\":\""+m.t+"\",\"id\":\""+m.id+"\"}");}}}var rstr=str.join(",");var rq_url=TQKF.float_server_url+"/getonlinestatus.js?adminid="+tq_adminid+"&sort="+tq_sort+"&m=["+rstr+"]&callback=TQKF.floater.RefreshOnlineStatus&nocache="+Math.random();TQUtils.LoadJSAndAutoRemoveSelf("TQGetonlinestatus_JS_float",rq_url);TQKF.getOnlineFlagInteval+=2000;setTimeout(function(){TQKF.floater.GetOnlineStatus();},TQKF.getOnlineFlagInteval);},RefreshOnlineStatus:function(m_flags){var index=0;for(var i=0;i<tq_member_uins.length;i++){for(var j=0;j<tq_member_uins[i].m.length;j++){var m=tq_member_uins[i].m[j];if(m.t=="tq"||m.t=="tactic"){m.o=m_flags[index].o;index++;}}}TQUtils.GetObj("tq_float_m_content").innerHTML=this.DrawContent();},FixMemberHeight:function(){var h=20;if(tq_group_flag==0){if(tq_member_uins[0].m.length==1)h=40;else if(tq_member_uins[0].m.length<=3)h=25;else h=20;}return h;},CreatImgURL:function(img,name){return img==""?(TQKF.float_image_url+'t'+this.t+'/s'+this.s+'/c'+this.c+'/'+name+'.'+this.defaultCfg["t"+this.t]["s"+this.s].img_ext):img;},CreatOnlineStateImgURL:function(img,name){return img==""?(TQKF.float_image_url+'onlinestate/s'+this.userCfg.onlinestate.s+'/'+name+'.gif'):img;},CreatMiniImgURL:function(s){var align="l";if(tq_float_right<0)align="r";return s==100?this.userCfg.mini.img:(TQKF.float_image_url+'mini/s'+s+'/c'+this.c+'/mini_'+align+'.'+this.miniCfg["s"+this.userCfg.mini.s].ext);},Toggle:function(obj){for(var i=0;i<tq_member_uins.length;i++){document.getElementById("tq_float_term"+i+"_member")&&(document.getElementById("tq_float_term"+i+"_member").style.display="none");}document.getElementById(obj.id+"_member").style.display="";},GetLen:function(str){var totallength=0;for(var i=0;i<str.length;i++){var intCode=str.charCodeAt(i);if(intCode>=0&&intCode<=128){totallength=totallength+1;}else{totallength=totallength+2;}}return totallength;},IfAllOffLine:function(){{try{for(var i=0;i<tq_member_uins.length;i++){for(var j=0;j<tq_member_uins[i].m.length;j++){if((tq_member_uins[i].m[j].t=="tq"||tq_member_uins[i].m[j].t=="tactic")&&TQUtils.isInCode(tq_member_uins[i].m[j].o,TQKF.ONLINE)){return false;}}}return true;}catch(e){return false;}}},OpenChatWin:function(uin,state){if(TQUtils.isInCode(state,TQKF.ONLINE)){TQKF.OpenWindow(TQKF.CreatURL(TQKF.webchat_url2,"chat",uin,"","float"),uin);}else{TQKF.OpenWindow(TQKF.CreatURL(TQKF.leavemsg_url,"leavemsg&tag=message",uin,"","float"),"");}},OpenTacticChatWin:function(tacticCode){TQKF.OpenWindow(TQKF.CreatURL(TQKF.pageinfo_url,"acd","",tacticCode,"float"),"");},OpenCallback:function(){if(this.userCfg.down.herf==""||this.userCfg.down.herf.indexOf("action=leavemsg")!=-1){TQKF.OpenWindow(TQKF.CreatURL(TQKF.leavemsg_url,"leavemsg&tag=call",tq_adminid,"","float"),"");}else{if(this.userCfg.down.herf.indexOf("http://")!=0)this.userCfg.down.herf="http://"+this.userCfg.down.herf;window.open(this.userCfg.down.herf);}},OpenAgentSite:function(){var defaultValue=TQKF.domain_url;if(typeof(tq_homepage)!="undefined"&&tq_homepage!="")defaultValue=tq_homepage;TQKF.floater.userCfg.btm.herf=TQUtils.setDefaultValue(defaultValue,TQKF.floater.userCfg.btm.herf);if(this.userCfg.btm.herf.indexOf("http://")!=0)this.userCfg.btm.herf="http://"+this.userCfg.btm.herf;window.open(TQKF.floater.userCfg.btm.herf);},ResetPos:function(){if(TQKF.userDefined.isfloat==2&&TQUtils.isSupportFixedPos)return;if(parseInt(tq_float_right)<0){if(parseInt(TQKF.floater.DOM.offsetWidth)==0){setTimeout(function(){TQKF.floater.ResetPos();},1000);}else{if(TQKF.floater.userCfg.mini.disp==0||TQKF.floater.userCfg.mini.disp=="")TQKF.floater.DOM.style.left=(TQUtils.GetScrollLeft()+TQUtils.GetWinSize().w-parseInt(TQKF.floater.DOM.offsetWidth)+parseInt(tq_float_right)+1)+"px";else TQKF.floater.DOM.style.left=(TQUtils.GetScrollLeft()+TQUtils.GetWinSize().w-parseInt(TQKF.floater.DOM.offsetWidth))+"px";}}},Anti:function(){TQKF.floater.AntiKaKa(TQKF.floater.DOM,"TQKF.floater",TQKF.floater.DOMinnerHTML);},AntiKaKa:function(div,checkElement,savedHTML){if(TQKF.floater.isAntiKaKa&&!TQKF.floater.isClosed&&!TQKF.floater.isHided){if(div.innerHTML.indexOf(checkElement)==-1){div.innerHTML=savedHTML;TQKF.floater.isAntiKaKa=false;}if(div.style.visibility=="hidden")div.style.visibility="visible";if(div.style.display=="none")div.style.display="";}},Mini:function(){if(TQKF.floater.isMouseInBox)return;var mini=TQUtils.GetObj("tq_float_mini_container");var normal=TQUtils.GetObj("tq_float_normal_container");mini.style.display="";normal.style.display="none";this.ResetPos();if(TQKF.floater.DOM.style.visibility=="hidden")TQKF.floater.DOM.style.visibility="visible";TQKF.floater.isMouseInBox=true;setTimeout(function(){TQKF.floater.isMouseInBox=false;},10);},Max:function(){if(TQKF.floater.isMouseInBox)return;var mini=TQUtils.GetObj("tq_float_mini_container");var normal=TQUtils.GetObj("tq_float_normal_container");mini.style.display="none";normal.style.display="";this.ResetPos();TQKF.floater.isMouseInBox=true;setTimeout(function(){TQKF.floater.isMouseInBox=false;},10);},Close:function(){if(this.userCfg.mini.disp!="1"&&this.userCfg.mini.disp!="2"){this.isClosed=true;this.Hide();clearInterval(TQKF.floater.autiTimer);}else this.Mini();if(TQKF.userDefined.float_reshow_type==3){TQKF.floater.isClosed=false;try{TQKF.floater.autoReshowTimer=setTimeout(function(){if(TQKF.floater.userCfg.mini.disp!="1"&&TQKF.floater.userCfg.mini.disp!="2"){TQKF.floater.Show();}else TQKF.floater.Max();},(TQKF.userDefined.float_reshow_inteval)*1000);}catch(e){}}},AutoShrink:function(event){if(event){if(typeof(HTMLElement)!="undefined"){if(document.getElementById("tq_float_normal_container").contains(event.relatedTarget)){return;}}else{if(document.getElementById("tq_float_normal_container").contains(event.toElement))return;}this.Close();}},Hide:function(){this.isHided=true;this.DOM.style.visibility="hidden";},Show:function(){try{clearTimeout(TQKF.floater.autoReshowTimer);}catch(e){}if(TQKF.userDefined.float_reshow_type==1){try{var tq_float_showed=TQUtils.GetCookie("tq_float_showed");if(tq_float_showed==1){return;}TQUtils.SetCookie("tq_float_showed","1",TQKF.userDefined.float_show_time*(1/60));}catch(e){}}else if(TQKF.userDefined.float_reshow_type==2){try{var tq_float_showed=TQUtils.GetCookie("tq_float_showed");if(tq_float_showed==1){return;}TQUtils.SetCookie("tq_float_showed","1",60*(1/60));}catch(e){}}else if(TQKF.userDefined.float_reshow_type==4){try{var tq_float_showed_site=TQUtils.GetCookie("tq_float_showed_site");if(tq_float_showed_site==1){return;}TQUtils.SetCookie2("tq_float_showed_site","1",TQKF.userDefined.float_domain_show_time*(1/60));}catch(e){}}if(this.isClosed==false){this.DOM.style.visibility="visible";TQKF.floater.autiTimer=window.setInterval(TQKF.floater.Anti,3000);this.isHided=false;TQKF.floater.showTimes++;}},Init:function(){TQ_DEBUG("TQKF.floater.Init()",3);if(TQKF.floater.hasInited)return;TQKF.floater.hasInited=true;TQKF.floater.AppendDOM();if(TQKF.floater.userCfg.mini.disp==1){TQKF.floater.Mini();}else{TQKF.floater.Show();}if(TQKF.userDefined.isfloat==1)TQUtils.HeartBeat(TQKF.floater.DOM,20,TQKF.floater.heartBeatTimer,{x:0,y:0},(!TQKF.floater.isClosed));else if(TQKF.userDefined.isfloat==2){if(TQUtils.isSupportFixedPos==false){setInterval(function(){TQKF.floater.DOM.style.top=(TQUtils.GetScrollTop()+parseInt(tq_top))+"px";TQKF.floater.ResetPos();},5);}}TQUtils.AddEvent(window,"resize",TQKF.floater.ResetPos);if(TQKF.floater.userCfg.mini.disp==0||TQKF.floater.userCfg.mini.disp==""){if(TQUtils.isSupportFixedPos==true&&TQKF.userDefined.isfloat==2){TQUtils.Drag.init(TQUtils.GetObj("tq_float_head"),TQKF.floater.DOM,null,null,null,null,(parseInt(tq_float_right)<0&&TQUtils.isSupportFixedPos)?true:false,false);}else TQUtils.Drag.init(TQUtils.GetObj("tq_float_head"),TQKF.floater.DOM);}if(parseInt(tq_float_right)<0)setTimeout(function(){TQKF.floater.ResetPos();},10);}};if(tq_version==""||parseInt(tq_version)<parseInt(TQKF.version)){TQUtils.SetValueIfUndefined("tq_float_type",1);TQUtils.SetValueIfUndefined("tq_float_style",1);TQUtils.SetValueIfUndefined("tq_is_fold_term",0);TQUtils.SetValueIfUndefined("tq_float_html","");TQUtils.SetValueIfUndefined("TQKF.chattype","");TQKF.floater.t=tq_float_type;TQKF.floater.s=tq_float_style;tq_down_url=TQUtils.setDefaultValue(TQKF.leavemsg_url,tq_down_url);tq_bottom_url=TQUtils.setDefaultValue(TQKF.domain_url,tq_bottom_url);tq_float_layout_cfg={img_ext:"gif",term:{img:tq_group_bg_img,h:"20"},head:{img:tq_up_img,w:"118",h:"35"},body:{img:tq_middle_img,margin:3},down:{img:tq_down_img,tip:"",herf:tq_down_url,disp:""},btm:{img:tq_bottom_img,tip:tq_bottom_tips,herf:tq_bottom_url},icoon:{img:tq_online_icon},icooff:{img:tq_offline_icon},on:{img:tq_online_gif},off:{img:tq_online_gif},busy:{img:tq_online_gif},leave:{img:tq_online_gif},title:{t:"6",l:"5",h:"16",w:"85"},close:{t:"3",r:"3",h:"16",w:"16"},mini:{s:"1",img:"",disp:"0"}};var temp=[];if(tq_type==4){tq_type=1;tq_float_type=2;TQKF.floater.t=2;TQKF.floater.s=1;var term={};term.n="";term.b="";term.h="";term.m=[];var uins=tq_language_type.split("|");for(var m=0;m<uins.length;m++){var member={};member.id=uins[m];member.n=tq_tacticTermName[m];member.t="tactic";member.w="";member.o=(tq_tacticTermOnlineFlag[m]==true||tq_tacticTermOnlineFlag[m]=="true")?22:0;term.m.push(member);}temp.push(term);}else{if(tq_group_counts.length==0)tq_group_flag=0;if(tq_group_flag==1){var t=0;for(var i=0;i<tq_group_names.length;i++){var term={};term.n=tq_group_names[i];term.b=tq_group_bg_img;term.h="";term.m=[];for(var j=0;j<tq_group_counts[i];j++){var member={};member.t="tq";member.n=tq_OnUserNameArray[t];member.id=tq_member_uins[t];member.o=tq_OnLineFlagArray[t];member.w=tq_member_titles[t];term.m.push(member);t++;}temp.push(term);}}else{var term={};term.n="";term.b="";term.h="";term.m=[];for(var j=0;j<tq_OnUserNameArray.length;j++){var member={};member.t="tq";member.n=tq_OnUserNameArray[j];member.id=tq_member_uins[j];member.o=tq_OnLineFlagArray[j];member.w=tq_member_titles[j];term.m.push(member);}temp.push(term);}}tq_member_uins=temp;}if(typeof(tq_float_layout_cfg)=="string"&&tq_float_layout_cfg!=""){eval('TQKF.floater.float_layout_cfg='+tq_float_layout_cfg)}if(typeof(tq_member_uins)=="string"&&tq_member_uins!=""){eval('tq_member_uins = '+tq_member_uins)}if(typeof(TQKF.floater.float_layout_cfg.body.sort)!="undefined"&&TQKF.floater.float_layout_cfg.body.sort==1){if(tq_member_uins.length>0&&tq_member_uins[0].m){for(var i=0;i<tq_member_uins.length;i++)tq_member_uins[i].m=TQKF.floater.SortMemberByOnlineFlag(tq_member_uins[i].m)}}try{if(TQKF.userDefined.tacticFloaterWidth!="auto")TQKF.floater.float_layout_cfg.head.w=TQKF.userDefined.tacticFloaterWidth}catch(e){}TQKF.floater.CreatDOM();setTimeout(TQKF.floater.Init,500);if(TQKF.isUpdateOnlineFlag==1){setTimeout(function(){TQKF.floater.GetOnlineStatus()},TQKF.getOnlineFlagInteval)}if(typeof(tq_is_minimess)!="undefined"&&tq_is_minimess==2&&TQKF.floater.IfAllOffLine()==true&&TQKF.isMinimessLoaded==false){TQUtils.LoadJS(TQKF.userDefined.minimessJS,TQKF.userDefined.defer);TQKF.isMinimessLoaded=true}